---
import '../styles/global.css';

interface Props {
  title: string;
  activePage: 'dashboard' | 'pacientes' | 'accesibilidad';
}

const { title, activePage } = Astro.props;
---

<!DOCTYPE html>
<html lang="es" class="transition-colors duration-300">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{title} - LeftJoiners</title>
  <link rel="icon" href="/favicon.png" type="image/png" />
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
  <link href="https://fonts.cdnfonts.com/css/opendyslexic" rel="stylesheet" />
  <script is:inline>
    (function() {
      const theme = localStorage.getItem('theme') || 'light';
      if (theme === 'dark') {
        document.documentElement.classList.add('dark');
      } else {
        document.documentElement.classList.remove('dark');
      }
      
      // Aplicar fuente OpenDyslexic si está activada
      const useDyslexicFont = localStorage.getItem('dyslexic-font') === 'true';
      if (useDyslexicFont) {
        document.documentElement.classList.add('dyslexic-font');
      }
    })();
  </script>
  <style>
    .material-symbols-outlined {
      font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
      font-size: 24px !important;
    }
    
    /* Aplicar OpenDyslexic cuando esté activado - texto general más pequeño */
    html.dyslexic-font body,
    html.dyslexic-font p,
    html.dyslexic-font span:not(.material-symbols-outlined),
    html.dyslexic-font div:not(:has(.material-symbols-outlined)),
    html.dyslexic-font input,
    html.dyslexic-font textarea,
    html.dyslexic-font select,
    html.dyslexic-font label,
    html.dyslexic-font li,
    html.dyslexic-font td,
    html.dyslexic-font th {
      font-family: 'OpenDyslexic', Arial, sans-serif !important;
      font-size: 90% !important;
      line-height: 1.6 !important;
    }
    
    /* Títulos con OpenDyslexic */
    html.dyslexic-font h1 {
      font-family: 'OpenDyslexic', Arial, sans-serif !important;
      font-size: 100% !important;
      line-height: 1.6 !important;
    }
    
    html.dyslexic-font h2 {
      font-family: 'OpenDyslexic', Arial, sans-serif !important;
      font-size: 100% !important;
      line-height: 1.6 !important;
    }
    
    html.dyslexic-font h3,
    html.dyslexic-font h4,
    html.dyslexic-font h5,
    html.dyslexic-font h6 {
      font-family: 'OpenDyslexic', Arial, sans-serif !important;
      font-size: 92% !important;
      line-height: 1.6 !important;
    }
    
    /* Título "Left Joiners" en sidebar */
    html.dyslexic-font .sidebar-title {
      font-family: 'OpenDyslexic', Arial, sans-serif !important;
      font-size: 125% !important;
      line-height: 1.4 !important;
    }
    
    /* Título "Left Joiners" en header móvil */
    html.dyslexic-font .header-title {
      font-family: 'OpenDyslexic', Arial, sans-serif !important;
      font-size: 125% !important;
      line-height: 1.4 !important;
    }
    
    /* Título de la página en header desktop (ej: "Configuración de Accesibilidad") */
    html.dyslexic-font .page-title {
      font-family: 'OpenDyslexic', Arial, sans-serif !important;
      font-size: 140% !important;
      line-height: 1.4 !important;
    }
    
    /* Menús de navegación MÁS GRANDES */
    html.dyslexic-font nav a,
    html.dyslexic-font nav p,
    html.dyslexic-font aside a,
    html.dyslexic-font aside p,
    html.dyslexic-font header a,
    html.dyslexic-font header button {
      font-family: 'OpenDyslexic', Arial, sans-serif !important;
      font-size: 105% !important;
      line-height: 1.6 !important;
    }
    
    /* Enlaces y botones en general */
    html.dyslexic-font a,
    html.dyslexic-font button {
      font-family: 'OpenDyslexic', Arial, sans-serif !important;
      font-size: 90% !important;
    }
    
    /* NO aplicar a iconos Material Symbols - NUNCA cambiar tamaño ni fuente */
    html.dyslexic-font .material-symbols-outlined,
    .material-symbols-outlined {
      font-family: 'Material Symbols Outlined' !important;
      font-size: 24px !important;
      line-height: 1 !important;
    }
    
    /* Iconos grandes específicos mantienen su tamaño */
    html.dyslexic-font .material-symbols-outlined[style*="font-size: 32px"],
    .material-symbols-outlined[style*="font-size: 32px"] {
      font-size: 32px !important;
    }
    
    /* NO aplicar a código */
    html.dyslexic-font code,
    html.dyslexic-font pre {
      font-family: monospace !important;
      font-size: inherit !important;
    }
  </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-[#1F2937] dark:text-gray-200">
  <div class="relative flex min-h-screen w-full max-w-full overflow-x-hidden">
    
    {/* SIDEBAR - Visible en pantallas grandes (a la IZQUIERDA) - FIXED */}
    <aside class="hidden xl:flex xl:flex-col xl:w-64 xl:min-w-64 xl:max-w-64 xl:border-r border-gray-200 dark:border-gray-700 bg-white dark:bg-[#1F2937] xl:fixed xl:left-0 xl:top-0 xl:h-screen xl:overflow-y-auto">
      {/* Header del Sidebar - Misma altura que el header superior */}
      <div class="flex items-center px-6 border-b border-gray-200 dark:border-gray-700 h-[73px] flex-shrink-0">
        <div class="flex items-center gap-3">
          <div class="text-primary">
            <span class="material-symbols-outlined" style="font-size: 32px;">health_and_safety</span>
          </div>
          <div class="flex flex-col">
            <h1 class="text-lg font-bold sidebar-title">Left Joiners</h1>
            <p class="text-xs text-gray-500 dark:text-gray-400">Portal de Datos Médicos</p>
          </div>
        </div>
      </div>

      {/* Navegación Vertical */}
      <nav class="flex flex-col gap-2 px-4 py-6 flex-1 overflow-y-auto">
        <a 
          class={`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${
            activePage === 'dashboard' 
              ? 'bg-primary/20 text-primary dark:bg-primary/30' 
              : 'hover:bg-gray-100 dark:hover:bg-gray-700'
          }`}
          href="/"
        >
          <span class="material-symbols-outlined">dashboard</span>
          <p class="text-sm font-medium">Dashboard</p>
        </a>
        <a 
          class={`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${
            activePage === 'pacientes' 
              ? 'bg-primary/20 text-primary dark:bg-primary/30' 
              : 'hover:bg-gray-100 dark:hover:bg-gray-700'
          }`}
          href="/pacientes"
        >
          <span class="material-symbols-outlined">group</span>
          <p class="text-sm font-medium">Pacientes</p>
        </a>
        <a 
          class={`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${
            activePage === 'accesibilidad' 
              ? 'bg-primary/20 text-primary dark:bg-primary/30' 
              : 'hover:bg-gray-100 dark:hover:bg-gray-700'
          }`}
          href="/accesibilidad"
        >
          <span class="material-symbols-outlined">accessibility_new</span>
          <p class="text-sm font-medium">Accesibilidad</p>
        </a>
      </nav>
	  
      {/* User Info - Footer del Sidebar */}
      <div class="mt-auto px-4 py-4 flex-shrink-0">

		
      </div>
    </aside>

    {/* CONTENIDO PRINCIPAL - Con margen para el sidebar en desktop */}
    <div class="flex flex-col flex-1 min-w-0 xl:ml-64">
      
      {/* HEADER SUPERIOR - Visible SIEMPRE (en todas las resoluciones) - FIXED */}
      <header class="flex items-center justify-between px-4 sm:px-6 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-[#1F2937] sticky top-0 z-10 h-[73px]">
        {/* Logo y título - Solo visible en móvil/tablet */}
        <div class="flex items-center gap-2 xl:hidden min-w-0 flex-shrink">
          <div class="text-primary flex-shrink-0">
            <span class="material-symbols-outlined" style="font-size: 28px;">health_and_safety</span>
          </div>
          <div class="flex flex-col min-w-0">
            <h1 class="text-sm sm:text-base font-bold header-title truncate">Left Joiners</h1>
            <p class="text-xs text-gray-500 dark:text-gray-400 truncate">Portal de Datos Médicos</p>
          </div>
        </div>

        {/* Título de la página - Solo visible en desktop cuando hay sidebar */}
        <div class="hidden xl:block xl:flex-1 xl:max-w-lg xl:mr-4">
          <h2 class="text-xl font-bold page-title truncate">{title}</h2>
        </div>

        {/* Acciones del header */}
        <div class="flex items-center gap-2 ml-auto xl:ml-0 flex-shrink-0">
          {/* ----------------------------------------------------------------------------------------------------- borrar?-------------- */}
          
            {/* ----------------------------------------------------------------------------------------------------- borrar?-------------- */}


          {/* Botón de menú móvil - Solo en pantallas muy pequeñas */}
          <button 
            id="mobile-menu-button"
            class="sm:hidden flex items-center justify-center w-10 h-10 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors flex-shrink-0"
            aria-label="Abrir menú"
          >
            <span class="material-symbols-outlined">menu</span>
          </button>
        </div>
      </header>

      {/* Navegación Horizontal - Solo visible en móvil/tablet PERO NO en pantallas muy pequeñas */}
      <nav class="hidden sm:flex xl:hidden items-center gap-2 px-4 sm:px-6 py-2 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-[#1F2937] overflow-x-auto">
          <a 
            class={`flex items-center gap-2 px-3 py-2 rounded-lg whitespace-nowrap transition-colors ${
              activePage === 'dashboard' 
                ? 'bg-primary/20 text-primary dark:bg-primary/30' 
                : 'hover:bg-gray-100 dark:hover:bg-gray-700'
            }`}
            href="/"
          >
            <span class="material-symbols-outlined">dashboard</span>
            <p class="text-sm font-medium">Dashboard</p>
          </a>
          <a 
            class={`flex items-center gap-2 px-3 py-2 rounded-lg whitespace-nowrap transition-colors ${
              activePage === 'pacientes' 
                ? 'bg-primary/20 text-primary dark:bg-primary/30' 
                : 'hover:bg-gray-100 dark:hover:bg-gray-700'
            }`}
            href="/pacientes"
          >
            <span class="material-symbols-outlined">group</span>
            <p class="text-sm font-medium">Pacientes</p>
          </a>
          <a 
            class={`flex items-center gap-2 px-3 py-2 rounded-lg whitespace-nowrap transition-colors ${
              activePage === 'accesibilidad' 
                ? 'bg-primary/20 text-primary dark:bg-primary/30' 
                : 'hover:bg-gray-100 dark:hover:bg-gray-700'
            }`}
            href="/accesibilidad"
          >
            <span class="material-symbols-outlined">accessibility_new</span>
            <p class="text-sm font-medium">Accesibilidad</p>
          </a>
        </nav>

      {/* CONTENIDO DE LA PÁGINA */}
      <main class="flex-1 flex flex-col overflow-hidden">
        <slot />
      </main>
    </div>

    {/* Overlay del menú móvil - Solo en pantallas pequeñas */}
    <div 
      id="menu-overlay" 
      class="fixed inset-0 bg-black/50 z-40 sm:hidden hidden transition-opacity"
    ></div>

    {/* Menú desplegable móvil - Solo en pantallas pequeñas */}
    <div 
      id="mobile-menu"
      class="fixed top-0 right-0 h-full w-80 max-w-[85vw] bg-white dark:bg-[#1F2937] border-l border-gray-200 dark:border-gray-700 z-50 sm:hidden transform translate-x-full transition-transform duration-300 ease-in-out shadow-2xl"
    >
      {/* Header del menú */}
      <div class="flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700">
        <h2 class="text-lg font-bold">Menú</h2>
        <button 
          id="close-menu-button"
          class="flex items-center justify-center w-10 h-10 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
          aria-label="Cerrar menú"
          onclick="document.getElementById('mobile-menu-button').click()"
        >
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>

      {/* Información del usuario */}
      <div class="px-6 py-4 ">

      </div>

      {/* Navegación */}
      <nav class="flex flex-col gap-2 px-4 py-6">
        <a 
          class={`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${
            activePage === 'dashboard' 
              ? 'bg-primary/20 text-primary dark:bg-primary/30' 
              : 'hover:bg-gray-100 dark:hover:bg-gray-700'
          }`}
          href="/"
        >
          <span class="material-symbols-outlined">dashboard</span>
          <p class="text-sm font-medium">Dashboard</p>
        </a>
        <a 
          class={`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${
            activePage === 'pacientes' 
              ? 'bg-primary/20 text-primary dark:bg-primary/30' 
              : 'hover:bg-gray-100 dark:hover:bg-gray-700'
          }`}
          href="/pacientes"
        >
          <span class="material-symbols-outlined">group</span>
          <p class="text-sm font-medium">Pacientes</p>
        </a>
        <a 
          class={`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${
            activePage === 'accesibilidad' 
              ? 'bg-primary/20 text-primary dark:bg-primary/30' 
              : 'hover:bg-gray-100 dark:hover:bg-gray-700'
          }`}
          href="/accesibilidad"
        >
          <span class="material-symbols-outlined">accessibility_new</span>
          <p class="text-sm font-medium">Accesibilidad</p>
        </a>
      </nav>

      {/* Opciones adicionales */}

    </div>
  </div>

  <script>
    // Script para el menú móvil
    document.addEventListener('DOMContentLoaded', () => {
      const menuButton = document.getElementById('mobile-menu-button');
      const mobileMenu = document.getElementById('mobile-menu');
      const menuOverlay = document.getElementById('menu-overlay');
      
      if (menuButton && mobileMenu && menuOverlay) {
        const toggleMenu = () => {
          const isOpen = mobileMenu.classList.contains('translate-x-0');
          if (isOpen) {
            mobileMenu.classList.remove('translate-x-0');
            mobileMenu.classList.add('translate-x-full');
            menuOverlay.classList.add('hidden');
          } else {
            mobileMenu.classList.remove('translate-x-full');
            mobileMenu.classList.add('translate-x-0');
            menuOverlay.classList.remove('hidden');
          }
        };
        
        menuButton.addEventListener('click', toggleMenu);
        menuOverlay.addEventListener('click', toggleMenu);
      }
    });
  </script>
</body>
</html>
